<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta charset="utf-8" />
    <script src="../script/Endeavor.Skanetrafiken.formscriptfunctions.js"></script>
    <script src="../script/Endeavor.Skanetrafiken.Slots.js"></script>
    <title>Export Slots to Excel</title>
    <script src="../../ClientGlobalContext.js.aspx" type="text/javascript"></script>

    <style>

        .margin{
            margin: 0.5%;
        }

        .dateFieldsDiv {
            margin: 5%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .buttonsDiv {
            margin: 5%;
            display: flex;
            align-items: flex-end;
            justify-content: flex-end;
        }
    </style>

    <script type="text/javascript">

        function exportSlotsExcel() {

            debugger;
            var dateFrom = document.getElementById('fromdate');
            var dateTo = document.getElementById('todate');

            if (dateFrom == null || dateTo == null) {
                Endeavor.formscriptfunctions.AlertCustomDialog("Coding Error: The HTML element for From Date or To Date is not coded.");
                return;
            }

            dateFrom = dateFrom.value;
            dateTo = dateTo.value;

            if (dateFrom == '' || dateTo == '') {
                Endeavor.formscriptfunctions.AlertCustomDialog("Either From Date or To Date is null");
                return;
            }

            var inputParameters = [
                { "Field": "FromDate", "Value": dateFrom, "TypeName": Endeavor.formscriptfunctions.getParameterType("string"), "StructuralProperty": 1 },
                { "Field": "ToDate", "Value": dateTo, "TypeName": Endeavor.formscriptfunctions.getParameterType("string"), "StructuralProperty": 1 }
            ];

            Endeavor.Skanetrafiken.Slots.getExcelData(Xrm, inputParameters);
        }

        function cancel() {
            window.close();
        }

    </script>

</head>
<body>
    <div class="dateFieldsDiv">
        <label class="margin" for="fromdate">From Booking Date:</label>
        <input class="margin" type="date" id="fromdate" name="fromdate">

        <label class="margin" for="todate">To Booking Date:</label>
        <input class="margin" type="date" id="todate" to="todate">
    </div>

    <div class="buttonsDiv">
        <button class="margin" onclick="exportSlotsExcel()">Export Slots</button>
        <button class="margin" onclick="cancel()">Cancel</button>
    </div>

</body>
</html>